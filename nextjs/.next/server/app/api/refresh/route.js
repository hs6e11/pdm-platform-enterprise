"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/refresh/route";
exports.ids = ["app/api/refresh/route"];
exports.modules = {

/***/ "../../client/components/action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/client/components/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/action-async-storage.external.js");

/***/ }),

/***/ "../../client/components/request-async-storage.external":
/*!********************************************************************************!*\
  !*** external "next/dist/client/components/request-async-storage.external.js" ***!
  \********************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/request-async-storage.external.js");

/***/ }),

/***/ "../../client/components/static-generation-async-storage.external":
/*!******************************************************************************************!*\
  !*** external "next/dist/client/components/static-generation-async-storage.external.js" ***!
  \******************************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/static-generation-async-storage.external.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Frefresh%2Froute&page=%2Fapi%2Frefresh%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Frefresh%2Froute.ts&appDir=%2FUsers%2Fhemdanshalaby%2FPDM_PROJECT%2Fpdm-platform-v2%2Fnextjs%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fhemdanshalaby%2FPDM_PROJECT%2Fpdm-platform-v2%2Fnextjs&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Frefresh%2Froute&page=%2Fapi%2Frefresh%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Frefresh%2Froute.ts&appDir=%2FUsers%2Fhemdanshalaby%2FPDM_PROJECT%2Fpdm-platform-v2%2Fnextjs%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fhemdanshalaby%2FPDM_PROJECT%2Fpdm-platform-v2%2Fnextjs&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_hemdanshalaby_PDM_PROJECT_pdm_platform_v2_nextjs_src_app_api_refresh_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/refresh/route.ts */ \"(rsc)/./src/app/api/refresh/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/refresh/route\",\n        pathname: \"/api/refresh\",\n        filename: \"route\",\n        bundlePath: \"app/api/refresh/route\"\n    },\n    resolvedPagePath: \"/Users/hemdanshalaby/PDM_PROJECT/pdm-platform-v2/nextjs/src/app/api/refresh/route.ts\",\n    nextConfigOutput,\n    userland: _Users_hemdanshalaby_PDM_PROJECT_pdm_platform_v2_nextjs_src_app_api_refresh_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/refresh/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZyZWZyZXNoJTJGcm91dGUmcGFnZT0lMkZhcGklMkZyZWZyZXNoJTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGcmVmcmVzaCUyRnJvdXRlLnRzJmFwcERpcj0lMkZVc2VycyUyRmhlbWRhbnNoYWxhYnklMkZQRE1fUFJPSkVDVCUyRnBkbS1wbGF0Zm9ybS12MiUyRm5leHRqcyUyRnNyYyUyRmFwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9JTJGVXNlcnMlMkZoZW1kYW5zaGFsYWJ5JTJGUERNX1BST0pFQ1QlMkZwZG0tcGxhdGZvcm0tdjIlMkZuZXh0anMmaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNjO0FBQ29DO0FBQ2pIO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixnSEFBbUI7QUFDM0M7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZO0FBQ1osQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFFBQVEsaUVBQWlFO0FBQ3pFO0FBQ0E7QUFDQSxXQUFXLDRFQUFXO0FBQ3RCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDdUg7O0FBRXZIIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcGRtLWZyb250ZW5kLz84Y2ExIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi9Vc2Vycy9oZW1kYW5zaGFsYWJ5L1BETV9QUk9KRUNUL3BkbS1wbGF0Zm9ybS12Mi9uZXh0anMvc3JjL2FwcC9hcGkvcmVmcmVzaC9yb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvcmVmcmVzaC9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL3JlZnJlc2hcIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL3JlZnJlc2gvcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCIvVXNlcnMvaGVtZGFuc2hhbGFieS9QRE1fUFJPSkVDVC9wZG0tcGxhdGZvcm0tdjIvbmV4dGpzL3NyYy9hcHAvYXBpL3JlZnJlc2gvcm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcyB9ID0gcm91dGVNb2R1bGU7XG5jb25zdCBvcmlnaW5hbFBhdGhuYW1lID0gXCIvYXBpL3JlZnJlc2gvcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Frefresh%2Froute&page=%2Fapi%2Frefresh%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Frefresh%2Froute.ts&appDir=%2FUsers%2Fhemdanshalaby%2FPDM_PROJECT%2Fpdm-platform-v2%2Fnextjs%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fhemdanshalaby%2FPDM_PROJECT%2Fpdm-platform-v2%2Fnextjs&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/refresh/route.ts":
/*!**************************************!*\
  !*** ./src/app/api/refresh/route.ts ***!
  \**************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_api__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/api */ \"(rsc)/./src/lib/api.ts\");\n/* harmony import */ var _lib_auth__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/auth */ \"(rsc)/./src/lib/auth.ts\");\n\n\n\nasync function POST(req) {\n    if (!_lib_api__WEBPACK_IMPORTED_MODULE_1__.BACKEND_REFRESH_PATH) {\n        // Try to reuse current access token from cookie (e.g., page reload)\n        const access = req.cookies.get(_lib_auth__WEBPACK_IMPORTED_MODULE_2__.ACCESS_COOKIE)?.value;\n        if (access) return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            access_token: access\n        }, {\n            status: 200\n        });\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Refresh not configured\"\n        }, {\n            status: 501\n        });\n    }\n    const refresh = req.cookies.get(_lib_auth__WEBPACK_IMPORTED_MODULE_2__.REFRESH_COOKIE)?.value;\n    if (!refresh) return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n        error: \"No refresh token\"\n    }, {\n        status: 401\n    });\n    const resp = await fetch((0,_lib_api__WEBPACK_IMPORTED_MODULE_1__.backendUrl)(_lib_api__WEBPACK_IMPORTED_MODULE_1__.BACKEND_REFRESH_PATH), {\n        method: \"POST\",\n        headers: {\n            \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify({\n            refresh_token: refresh\n        })\n    });\n    const data = await resp.json().catch(()=>({}));\n    if (!resp.ok) return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n        error: data?.detail ?? \"Refresh failed\"\n    }, {\n        status: resp.status\n    });\n    const access = data.access_token || data.token || null;\n    if (!access) return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n        error: \"No access token\"\n    }, {\n        status: 500\n    });\n    const res = next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n        access_token: access\n    });\n    const common = {\n        httpOnly: true,\n        secure: true,\n        sameSite: \"lax\",\n        path: \"/\"\n    };\n    res.cookies.set(_lib_auth__WEBPACK_IMPORTED_MODULE_2__.ACCESS_COOKIE, access, common);\n    return res;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS9yZWZyZXNoL3JvdXRlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBd0Q7QUFDSztBQUNGO0FBRXBELGVBQWVLLEtBQUtDLEdBQWdCO0lBQ3pDLElBQUksQ0FBQ0wsMERBQW9CQSxFQUFFO1FBQ3pCLG9FQUFvRTtRQUNwRSxNQUFNTSxTQUFTRCxJQUFJRSxPQUFPLENBQUNDLEdBQUcsQ0FBQ04sb0RBQWFBLEdBQUdPO1FBQy9DLElBQUlILFFBQVEsT0FBT1AscURBQVlBLENBQUNXLElBQUksQ0FBQztZQUFFQyxjQUFjTDtRQUFPLEdBQUc7WUFBRU0sUUFBUTtRQUFJO1FBQzdFLE9BQU9iLHFEQUFZQSxDQUFDVyxJQUFJLENBQUM7WUFBRUcsT0FBTztRQUF5QixHQUFHO1lBQUVELFFBQVE7UUFBSTtJQUM5RTtJQUVBLE1BQU1FLFVBQVVULElBQUlFLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDTCxxREFBY0EsR0FBR007SUFDakQsSUFBSSxDQUFDSyxTQUFTLE9BQU9mLHFEQUFZQSxDQUFDVyxJQUFJLENBQUM7UUFBRUcsT0FBTztJQUFtQixHQUFHO1FBQUVELFFBQVE7SUFBSTtJQUVwRixNQUFNRyxPQUFPLE1BQU1DLE1BQU1mLG9EQUFVQSxDQUFDRCwwREFBb0JBLEdBQUc7UUFDekRpQixRQUFRO1FBQ1JDLFNBQVM7WUFBRSxnQkFBZ0I7UUFBbUI7UUFDOUNDLE1BQU1DLEtBQUtDLFNBQVMsQ0FBQztZQUFFQyxlQUFlUjtRQUFRO0lBQ2hEO0lBRUEsTUFBTVMsT0FBTyxNQUFNUixLQUFLTCxJQUFJLEdBQUdjLEtBQUssQ0FBQyxJQUFPLEVBQUM7SUFDN0MsSUFBSSxDQUFDVCxLQUFLVSxFQUFFLEVBQUUsT0FBTzFCLHFEQUFZQSxDQUFDVyxJQUFJLENBQUM7UUFBRUcsT0FBT1UsTUFBTUcsVUFBVTtJQUFpQixHQUFHO1FBQUVkLFFBQVFHLEtBQUtILE1BQU07SUFBQztJQUUxRyxNQUFNTixTQUFTaUIsS0FBS1osWUFBWSxJQUFJWSxLQUFLSSxLQUFLLElBQUk7SUFDbEQsSUFBSSxDQUFDckIsUUFBUSxPQUFPUCxxREFBWUEsQ0FBQ1csSUFBSSxDQUFDO1FBQUVHLE9BQU87SUFBa0IsR0FBRztRQUFFRCxRQUFRO0lBQUk7SUFFbEYsTUFBTWdCLE1BQU03QixxREFBWUEsQ0FBQ1csSUFBSSxDQUFDO1FBQUVDLGNBQWNMO0lBQU87SUFDckQsTUFBTXVCLFNBQVM7UUFBRUMsVUFBVTtRQUFNQyxRQUFRO1FBQU1DLFVBQVU7UUFBZ0JDLE1BQU07SUFBSTtJQUNuRkwsSUFBSXJCLE9BQU8sQ0FBQzJCLEdBQUcsQ0FBQ2hDLG9EQUFhQSxFQUFFSSxRQUFRdUI7SUFDdkMsT0FBT0Q7QUFDVCIsInNvdXJjZXMiOlsid2VicGFjazovL3BkbS1mcm9udGVuZC8uL3NyYy9hcHAvYXBpL3JlZnJlc2gvcm91dGUudHM/ZDcwYSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVxdWVzdCwgTmV4dFJlc3BvbnNlIH0gZnJvbSBcIm5leHQvc2VydmVyXCI7XG5pbXBvcnQgeyBCQUNLRU5EX1JFRlJFU0hfUEFUSCwgYmFja2VuZFVybCB9IGZyb20gXCJAL2xpYi9hcGlcIjtcbmltcG9ydCB7IEFDQ0VTU19DT09LSUUsIFJFRlJFU0hfQ09PS0lFIH0gZnJvbSBcIkAvbGliL2F1dGhcIjtcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIFBPU1QocmVxOiBOZXh0UmVxdWVzdCkge1xuICBpZiAoIUJBQ0tFTkRfUkVGUkVTSF9QQVRIKSB7XG4gICAgLy8gVHJ5IHRvIHJldXNlIGN1cnJlbnQgYWNjZXNzIHRva2VuIGZyb20gY29va2llIChlLmcuLCBwYWdlIHJlbG9hZClcbiAgICBjb25zdCBhY2Nlc3MgPSByZXEuY29va2llcy5nZXQoQUNDRVNTX0NPT0tJRSk/LnZhbHVlO1xuICAgIGlmIChhY2Nlc3MpIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGFjY2Vzc190b2tlbjogYWNjZXNzIH0sIHsgc3RhdHVzOiAyMDAgfSk7XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IFwiUmVmcmVzaCBub3QgY29uZmlndXJlZFwiIH0sIHsgc3RhdHVzOiA1MDEgfSk7XG4gIH1cblxuICBjb25zdCByZWZyZXNoID0gcmVxLmNvb2tpZXMuZ2V0KFJFRlJFU0hfQ09PS0lFKT8udmFsdWU7XG4gIGlmICghcmVmcmVzaCkgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IFwiTm8gcmVmcmVzaCB0b2tlblwiIH0sIHsgc3RhdHVzOiA0MDEgfSk7XG5cbiAgY29uc3QgcmVzcCA9IGF3YWl0IGZldGNoKGJhY2tlbmRVcmwoQkFDS0VORF9SRUZSRVNIX1BBVEgpLCB7XG4gICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICBoZWFkZXJzOiB7IFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiIH0sXG4gICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyByZWZyZXNoX3Rva2VuOiByZWZyZXNoIH0pXG4gIH0pO1xuXG4gIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwLmpzb24oKS5jYXRjaCgoKSA9PiAoe30pKTtcbiAgaWYgKCFyZXNwLm9rKSByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogZGF0YT8uZGV0YWlsID8/IFwiUmVmcmVzaCBmYWlsZWRcIiB9LCB7IHN0YXR1czogcmVzcC5zdGF0dXMgfSk7XG5cbiAgY29uc3QgYWNjZXNzID0gZGF0YS5hY2Nlc3NfdG9rZW4gfHwgZGF0YS50b2tlbiB8fCBudWxsO1xuICBpZiAoIWFjY2VzcykgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IFwiTm8gYWNjZXNzIHRva2VuXCIgfSwgeyBzdGF0dXM6IDUwMCB9KTtcblxuICBjb25zdCByZXMgPSBOZXh0UmVzcG9uc2UuanNvbih7IGFjY2Vzc190b2tlbjogYWNjZXNzIH0pO1xuICBjb25zdCBjb21tb24gPSB7IGh0dHBPbmx5OiB0cnVlLCBzZWN1cmU6IHRydWUsIHNhbWVTaXRlOiBcImxheFwiIGFzIGNvbnN0LCBwYXRoOiBcIi9cIiB9O1xuICByZXMuY29va2llcy5zZXQoQUNDRVNTX0NPT0tJRSwgYWNjZXNzLCBjb21tb24pO1xuICByZXR1cm4gcmVzO1xufVxuIl0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsIkJBQ0tFTkRfUkVGUkVTSF9QQVRIIiwiYmFja2VuZFVybCIsIkFDQ0VTU19DT09LSUUiLCJSRUZSRVNIX0NPT0tJRSIsIlBPU1QiLCJyZXEiLCJhY2Nlc3MiLCJjb29raWVzIiwiZ2V0IiwidmFsdWUiLCJqc29uIiwiYWNjZXNzX3Rva2VuIiwic3RhdHVzIiwiZXJyb3IiLCJyZWZyZXNoIiwicmVzcCIsImZldGNoIiwibWV0aG9kIiwiaGVhZGVycyIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwicmVmcmVzaF90b2tlbiIsImRhdGEiLCJjYXRjaCIsIm9rIiwiZGV0YWlsIiwidG9rZW4iLCJyZXMiLCJjb21tb24iLCJodHRwT25seSIsInNlY3VyZSIsInNhbWVTaXRlIiwicGF0aCIsInNldCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/refresh/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/api.ts":
/*!************************!*\
  !*** ./src/lib/api.ts ***!
  \************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   BACKEND_REFRESH_PATH: () => (/* binding */ BACKEND_REFRESH_PATH),\n/* harmony export */   BACKEND_URL: () => (/* binding */ BACKEND_URL),\n/* harmony export */   backendUrl: () => (/* binding */ backendUrl),\n/* harmony export */   proxyRequest: () => (/* binding */ proxyRequest)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n\nconst BACKEND_URL = process.env.BACKEND_URL || \"http://localhost:8000\";\nconst BACKEND_REFRESH_PATH = process.env.BACKEND_REFRESH_PATH || \"\";\nfunction backendUrl(path) {\n    return `${BACKEND_URL}${path.startsWith(\"/\") ? path : `/${path}`}`;\n}\n// Helper for route handlers\nasync function proxyRequest(req, path) {\n    const url = new URL(req.url);\n    const target = backendUrl(`${path}${url.search}`);\n    const init = {\n        method: req.method,\n        headers: {\n            // Copy headers except host and accept-encoding\n            ...Object.fromEntries(Array.from(req.headers.entries()).filter(([k])=>![\n                    \"host\",\n                    \"accept-encoding\",\n                    \"content-length\"\n                ].includes(k.toLowerCase())))\n        },\n        body: req.method !== \"GET\" && req.method !== \"HEAD\" ? await req.arrayBuffer() : undefined,\n        redirect: \"manual\"\n    };\n    const resp = await fetch(target, init);\n    const buf = await resp.arrayBuffer();\n    const res = new next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse(buf, {\n        status: resp.status,\n        headers: resp.headers\n    });\n    return res;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL2FwaS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUF3RDtBQUVqRCxNQUFNQyxjQUFjQyxRQUFRQyxHQUFHLENBQUNGLFdBQVcsSUFBSSx3QkFBd0I7QUFDdkUsTUFBTUcsdUJBQXVCRixRQUFRQyxHQUFHLENBQUNDLG9CQUFvQixJQUFJLEdBQUc7QUFFcEUsU0FBU0MsV0FBV0MsSUFBWTtJQUNyQyxPQUFPLENBQUMsRUFBRUwsWUFBWSxFQUFFSyxLQUFLQyxVQUFVLENBQUMsT0FBT0QsT0FBTyxDQUFDLENBQUMsRUFBRUEsS0FBSyxDQUFDLENBQUMsQ0FBQztBQUNwRTtBQUVBLDRCQUE0QjtBQUNyQixlQUFlRSxhQUFhQyxHQUFnQixFQUFFSCxJQUFZO0lBQy9ELE1BQU1JLE1BQU0sSUFBSUMsSUFBSUYsSUFBSUMsR0FBRztJQUMzQixNQUFNRSxTQUFTUCxXQUFXLENBQUMsRUFBRUMsS0FBSyxFQUFFSSxJQUFJRyxNQUFNLENBQUMsQ0FBQztJQUNoRCxNQUFNQyxPQUFvQjtRQUN4QkMsUUFBUU4sSUFBSU0sTUFBTTtRQUNsQkMsU0FBUztZQUNQLCtDQUErQztZQUMvQyxHQUFHQyxPQUFPQyxXQUFXLENBQ25CQyxNQUFNQyxJQUFJLENBQUNYLElBQUlPLE9BQU8sQ0FBQ0ssT0FBTyxJQUFJQyxNQUFNLENBQUMsQ0FBQyxDQUFDQyxFQUFFLEdBQUssQ0FBQztvQkFBQztvQkFBUTtvQkFBbUI7aUJBQWlCLENBQUNDLFFBQVEsQ0FBQ0QsRUFBRUUsV0FBVyxLQUN4SDtRQUNIO1FBQ0FDLE1BQU1qQixJQUFJTSxNQUFNLEtBQUssU0FBU04sSUFBSU0sTUFBTSxLQUFLLFNBQVMsTUFBTU4sSUFBSWtCLFdBQVcsS0FBS0M7UUFDaEZDLFVBQVU7SUFDWjtJQUNBLE1BQU1DLE9BQU8sTUFBTUMsTUFBTW5CLFFBQVFFO0lBQ2pDLE1BQU1rQixNQUFNLE1BQU1GLEtBQUtILFdBQVc7SUFDbEMsTUFBTU0sTUFBTSxJQUFJakMscURBQVlBLENBQUNnQyxLQUFLO1FBQ2hDRSxRQUFRSixLQUFLSSxNQUFNO1FBQ25CbEIsU0FBU2MsS0FBS2QsT0FBTztJQUN2QjtJQUNBLE9BQU9pQjtBQUNUIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcGRtLWZyb250ZW5kLy4vc3JjL2xpYi9hcGkudHM/MmZhYiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVxdWVzdCwgTmV4dFJlc3BvbnNlIH0gZnJvbSBcIm5leHQvc2VydmVyXCI7XG5cbmV4cG9ydCBjb25zdCBCQUNLRU5EX1VSTCA9IHByb2Nlc3MuZW52LkJBQ0tFTkRfVVJMIHx8IFwiaHR0cDovL2xvY2FsaG9zdDo4MDAwXCI7XG5leHBvcnQgY29uc3QgQkFDS0VORF9SRUZSRVNIX1BBVEggPSBwcm9jZXNzLmVudi5CQUNLRU5EX1JFRlJFU0hfUEFUSCB8fCBcIlwiO1xuXG5leHBvcnQgZnVuY3Rpb24gYmFja2VuZFVybChwYXRoOiBzdHJpbmcpIHtcbiAgcmV0dXJuIGAke0JBQ0tFTkRfVVJMfSR7cGF0aC5zdGFydHNXaXRoKFwiL1wiKSA/IHBhdGggOiBgLyR7cGF0aH1gfWA7XG59XG5cbi8vIEhlbHBlciBmb3Igcm91dGUgaGFuZGxlcnNcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBwcm94eVJlcXVlc3QocmVxOiBOZXh0UmVxdWVzdCwgcGF0aDogc3RyaW5nKSB7XG4gIGNvbnN0IHVybCA9IG5ldyBVUkwocmVxLnVybCk7XG4gIGNvbnN0IHRhcmdldCA9IGJhY2tlbmRVcmwoYCR7cGF0aH0ke3VybC5zZWFyY2h9YCk7XG4gIGNvbnN0IGluaXQ6IFJlcXVlc3RJbml0ID0ge1xuICAgIG1ldGhvZDogcmVxLm1ldGhvZCxcbiAgICBoZWFkZXJzOiB7XG4gICAgICAvLyBDb3B5IGhlYWRlcnMgZXhjZXB0IGhvc3QgYW5kIGFjY2VwdC1lbmNvZGluZ1xuICAgICAgLi4uT2JqZWN0LmZyb21FbnRyaWVzKFxuICAgICAgICBBcnJheS5mcm9tKHJlcS5oZWFkZXJzLmVudHJpZXMoKSkuZmlsdGVyKChba10pID0+ICFbXCJob3N0XCIsIFwiYWNjZXB0LWVuY29kaW5nXCIsIFwiY29udGVudC1sZW5ndGhcIl0uaW5jbHVkZXMoay50b0xvd2VyQ2FzZSgpKSlcbiAgICAgICksXG4gICAgfSxcbiAgICBib2R5OiByZXEubWV0aG9kICE9PSBcIkdFVFwiICYmIHJlcS5tZXRob2QgIT09IFwiSEVBRFwiID8gYXdhaXQgcmVxLmFycmF5QnVmZmVyKCkgOiB1bmRlZmluZWQsXG4gICAgcmVkaXJlY3Q6IFwibWFudWFsXCIsXG4gIH07XG4gIGNvbnN0IHJlc3AgPSBhd2FpdCBmZXRjaCh0YXJnZXQsIGluaXQpO1xuICBjb25zdCBidWYgPSBhd2FpdCByZXNwLmFycmF5QnVmZmVyKCk7XG4gIGNvbnN0IHJlcyA9IG5ldyBOZXh0UmVzcG9uc2UoYnVmLCB7XG4gICAgc3RhdHVzOiByZXNwLnN0YXR1cyxcbiAgICBoZWFkZXJzOiByZXNwLmhlYWRlcnMsXG4gIH0pO1xuICByZXR1cm4gcmVzO1xufVxuIl0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsIkJBQ0tFTkRfVVJMIiwicHJvY2VzcyIsImVudiIsIkJBQ0tFTkRfUkVGUkVTSF9QQVRIIiwiYmFja2VuZFVybCIsInBhdGgiLCJzdGFydHNXaXRoIiwicHJveHlSZXF1ZXN0IiwicmVxIiwidXJsIiwiVVJMIiwidGFyZ2V0Iiwic2VhcmNoIiwiaW5pdCIsIm1ldGhvZCIsImhlYWRlcnMiLCJPYmplY3QiLCJmcm9tRW50cmllcyIsIkFycmF5IiwiZnJvbSIsImVudHJpZXMiLCJmaWx0ZXIiLCJrIiwiaW5jbHVkZXMiLCJ0b0xvd2VyQ2FzZSIsImJvZHkiLCJhcnJheUJ1ZmZlciIsInVuZGVmaW5lZCIsInJlZGlyZWN0IiwicmVzcCIsImZldGNoIiwiYnVmIiwicmVzIiwic3RhdHVzIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/api.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/auth.ts":
/*!*************************!*\
  !*** ./src/lib/auth.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ACCESS_COOKIE: () => (/* binding */ ACCESS_COOKIE),\n/* harmony export */   REFRESH_COOKIE: () => (/* binding */ REFRESH_COOKIE),\n/* harmony export */   TENANT_COOKIE: () => (/* binding */ TENANT_COOKIE),\n/* harmony export */   decodeToken: () => (/* binding */ decodeToken),\n/* harmony export */   getAccessTokenFromCookies: () => (/* binding */ getAccessTokenFromCookies),\n/* harmony export */   isExpired: () => (/* binding */ isExpired)\n/* harmony export */ });\n/* harmony import */ var next_headers__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/headers */ \"(rsc)/./node_modules/next/dist/api/headers.js\");\n/* harmony import */ var jwt_decode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! jwt-decode */ \"(rsc)/./node_modules/jwt-decode/build/esm/index.js\");\n\n\nconst ACCESS_COOKIE = \"access_token\";\nconst REFRESH_COOKIE = \"refresh_token\";\nconst TENANT_COOKIE = \"tenant_id\";\nfunction getAccessTokenFromCookies() {\n    return (0,next_headers__WEBPACK_IMPORTED_MODULE_0__.cookies)().get(ACCESS_COOKIE)?.value;\n}\nfunction decodeToken(token) {\n    if (!token) return null;\n    try {\n        return (0,jwt_decode__WEBPACK_IMPORTED_MODULE_1__.jwtDecode)(token);\n    } catch  {\n        return null;\n    }\n}\nfunction isExpired(payload) {\n    if (!payload?.exp) return false;\n    return Math.floor(Date.now() / 1000) >= payload.exp;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL2F1dGgudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFBdUM7QUFDQTtBQUVoQyxNQUFNRSxnQkFBZ0IsZUFBZTtBQUNyQyxNQUFNQyxpQkFBaUIsZ0JBQWdCO0FBQ3ZDLE1BQU1DLGdCQUFnQixZQUFZO0FBV2xDLFNBQVNDO0lBQ2QsT0FBT0wscURBQU9BLEdBQUdNLEdBQUcsQ0FBQ0osZ0JBQWdCSztBQUN2QztBQUVPLFNBQVNDLFlBQVlDLEtBQWM7SUFDeEMsSUFBSSxDQUFDQSxPQUFPLE9BQU87SUFDbkIsSUFBSTtRQUNGLE9BQU9SLHFEQUFTQSxDQUFhUTtJQUMvQixFQUFFLE9BQU07UUFDTixPQUFPO0lBQ1Q7QUFDRjtBQUVPLFNBQVNDLFVBQVVDLE9BQTBCO0lBQ2xELElBQUksQ0FBQ0EsU0FBU0MsS0FBSyxPQUFPO0lBQzFCLE9BQU9DLEtBQUtDLEtBQUssQ0FBQ0MsS0FBS0MsR0FBRyxLQUFLLFNBQVNMLFFBQVFDLEdBQUc7QUFDckQiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wZG0tZnJvbnRlbmQvLi9zcmMvbGliL2F1dGgudHM/NjY5MiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjb29raWVzIH0gZnJvbSBcIm5leHQvaGVhZGVyc1wiO1xuaW1wb3J0IHsgand0RGVjb2RlIH0gZnJvbSBcImp3dC1kZWNvZGVcIjtcblxuZXhwb3J0IGNvbnN0IEFDQ0VTU19DT09LSUUgPSBcImFjY2Vzc190b2tlblwiO1xuZXhwb3J0IGNvbnN0IFJFRlJFU0hfQ09PS0lFID0gXCJyZWZyZXNoX3Rva2VuXCI7XG5leHBvcnQgY29uc3QgVEVOQU5UX0NPT0tJRSA9IFwidGVuYW50X2lkXCI7XG5cbmV4cG9ydCB0eXBlIEp3dFBheWxvYWQgPSB7XG4gIHN1Yj86IHN0cmluZztcbiAgZXhwPzogbnVtYmVyO1xuICBpYXQ/OiBudW1iZXI7XG4gIHJvbGU/OiBzdHJpbmc7XG4gIHRlbmFudF9pZD86IHN0cmluZztcbiAgW2tleTogc3RyaW5nXTogYW55O1xufTtcblxuZXhwb3J0IGZ1bmN0aW9uIGdldEFjY2Vzc1Rva2VuRnJvbUNvb2tpZXMoKSB7XG4gIHJldHVybiBjb29raWVzKCkuZ2V0KEFDQ0VTU19DT09LSUUpPy52YWx1ZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGRlY29kZVRva2VuKHRva2VuPzogc3RyaW5nKSB7XG4gIGlmICghdG9rZW4pIHJldHVybiBudWxsO1xuICB0cnkge1xuICAgIHJldHVybiBqd3REZWNvZGU8Snd0UGF5bG9hZD4odG9rZW4pO1xuICB9IGNhdGNoIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNFeHBpcmVkKHBheWxvYWQ6IEp3dFBheWxvYWQgfCBudWxsKSB7XG4gIGlmICghcGF5bG9hZD8uZXhwKSByZXR1cm4gZmFsc2U7XG4gIHJldHVybiBNYXRoLmZsb29yKERhdGUubm93KCkgLyAxMDAwKSA+PSBwYXlsb2FkLmV4cDtcbn1cbiJdLCJuYW1lcyI6WyJjb29raWVzIiwiand0RGVjb2RlIiwiQUNDRVNTX0NPT0tJRSIsIlJFRlJFU0hfQ09PS0lFIiwiVEVOQU5UX0NPT0tJRSIsImdldEFjY2Vzc1Rva2VuRnJvbUNvb2tpZXMiLCJnZXQiLCJ2YWx1ZSIsImRlY29kZVRva2VuIiwidG9rZW4iLCJpc0V4cGlyZWQiLCJwYXlsb2FkIiwiZXhwIiwiTWF0aCIsImZsb29yIiwiRGF0ZSIsIm5vdyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/auth.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/jwt-decode"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Frefresh%2Froute&page=%2Fapi%2Frefresh%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Frefresh%2Froute.ts&appDir=%2FUsers%2Fhemdanshalaby%2FPDM_PROJECT%2Fpdm-platform-v2%2Fnextjs%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fhemdanshalaby%2FPDM_PROJECT%2Fpdm-platform-v2%2Fnextjs&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();